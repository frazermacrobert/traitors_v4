:root{
  --beige:#f4efe9;
  --beige-2:#f7eae0;
  --ink:#1c1a1a;
  --muted:#6b5e55;
  --red:#cc1f2a;
  --soft-red:#f9d6d9;
  --card-bg:#ffffffd9; /* rgba(255,255,255,.85) */
  --rail:rgba(0,0,0,.06);

  /* Static warm background tones */
  --bg-a:#f9f2ec;
  --bg-b:#f6e7dc;
  --bg-c:#f1d7c7;
}

*{ box-sizing:border-box; }
html,body{ height:100%; }

/* ---- Static warm gradient, no animation ---- */
html, body {
  min-height: 100%;
}

body{
  margin: 0;
  font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  color: var(--ink);
  background: linear-gradient(160deg, var(--bg-a) 0%, var(--bg-b) 40%, var(--bg-c) 100%);
  background-size: cover;
  background-attachment: fixed;   /* keeps the gradient fixed */
  position: relative;
}

/* When the game is ready, swap to the photo but keep it fixed */
body[data-game-ready='true'] {
  background-image: url('../assets/bg_office.jpg');
  background-position: center;
  background-size: cover;
  background-repeat: no-repeat;
  background-attachment: fixed;   /* keeps the image fixed */
}

/* ---------- App layout ---------- */
.app{ max-width:1200px; margin:0 auto; padding:16px 20px 40px; }

.header{ display:flex; align-items:center; justify-content:space-between; margin-bottom:8px; }
.title{ font-weight:800; letter-spacing:.4px; }
.badge{ padding:4px 8px; border:1px solid var(--rail); border-radius:999px; font-size:12px; color:var(--muted); }

.btn{ appearance:none; border:0; background:var(--red); color:#fff; padding:10px 14px; border-radius:12px; font-weight:700; cursor:pointer; box-shadow:0 6px 18px rgba(204,31,42,.25); }
.btn.secondary{ background:#fff; color:var(--red); border:1px solid var(--red); }

.topbar{
  position:sticky; top:0; z-index:1050;
  backdrop-filter: saturate(1.2) blur(6px);
  background:linear-gradient(180deg, rgba(244,239,233,.95), rgba(247,234,224,.85));
  padding:8px 0;
  border-bottom:1px solid var(--rail);
  display:grid; grid-template-columns: repeat(10, minmax(0,1fr)); gap:10px;
  margin-bottom:12px;
}

/* ---------- Cards ---------- */
.player-card{
  position:relative;
  background:var(--card-bg);
  border-radius:14px;
  padding:6px;
  box-shadow:0 1px 0 var(--rail), 0 12px 30px rgba(0,0,0,.08);
  border:1px solid var(--rail);
  display:flex; flex-direction:column; align-items:center; gap:6px;
  transition:.2s ease transform, .2s ease box-shadow, .2s ease border-color;
}
.player-card:hover{ transform:translateY(-2px); }
.player-card.eliminated{ opacity:.6; filter:grayscale(.5); }
.player-card.innocent{ background:#f0f0f0; }
.player-card.picked{ outline:2px solid var(--red); }

.player-card .name{ font-size:12px; text-align:center; }
.player-card img{ width:100%; border-radius:12px; border:1px solid var(--rail); background:#fff; }

.xmark{ position:absolute; inset:0; display:none; align-items:center; justify-content:center; font-weight:900; font-size:34px; text-shadow:0 2px 8px rgba(0,0,0,.25); mix-blend-mode:multiply; }
.player-chosen .xmark,
.player-card.eliminated .xmark{ display:flex; }
.player-card.by-vote .xmark{ color:#ffffff; }
.player-card.by-traitors .xmark{ color:#cc1f2a; }

.player-card .tag{
  position:absolute; top:6px; right:6px;
  font-size:10px; padding:2px 6px; border-radius:999px;
  border:1px solid var(--rail); background:#fff; color:var(--muted);
}

/* ---------- Main grid ---------- */
.grid{ display:grid; grid-template-columns: 1fr 1fr; gap:16px; }
.section{ padding:16px; border:1px solid var(--rail); border-radius:14px; background:var(--card-bg); backdrop-filter: blur(6px); }
.section h2{ margin:0 0 10px; font-size:14px; color:#402e2b; letter-spacing:.3px; }

.option{ display:block; margin:8px 0; padding:10px 12px; border-radius:10px; border:1px solid var(--rail); background:#fff; cursor:pointer; }

.actions-list{ display:grid; gap:8px; }
.action-item{
  padding:10px 12px;
  background:#fff;
  border:1px solid var(--rail);      /* fixed a harmless border typo */
  border-radius:10px;
  font-size:14px;
}
.action-item.r0{ border-left:4px solid #9ca3af; }
.action-item.r1{ border-left:4px solid #f59e0b; }
.action-item.r2{ border-left:4px solid #ef4444; }
.action-item.r3{ border-left:4px solid #b91c1c; }
.action-item.neutral{ border-left:4px solid #9ca3af; }

.note{ color:var(--muted); font-size:12px; }
.tally{ display:flex; gap:8px; flex-wrap:wrap; margin:8px 0; }
.pill{ background:#fff; border:1px solid var(--rail); border-radius:999px; padding:4px 8px; font-size:12px; }

/* ---------- Modals (Start / Log) ---------- */
.modal{
  position:fixed; inset:0;
  background:rgba(0,0,0,.40);
  display:none;
  align-items:center;
  justify-content:center;
  padding:20px;
  z-index: 2000;                      /* ensure above everything */
}
.modal.open{ display:flex; }

#startModal .dialog {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 20px;
    padding-bottom: 50px;
    background: transparent;
    box-shadow: none;
    border: none;
}

.main-logo {
    max-width: 500px;
    margin-bottom: 1rem;
}

.character-display-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
}

.character-image-frame {
    width: 150px;
    height: 150px;
    border-radius: 50%;
    border: 6px solid #fff;
    box-shadow: 0 0 15px rgba(0,0,0,0.2);
    overflow: hidden;
}

#character-preview-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.custom-select-wrapper {
    position: relative;
    width: 200px;
}

#playerSelect {
    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;
    width: 100%;
    padding: 10px 40px 10px 15px;
    border: 1px solid var(--rail);
    border-radius: 8px;
    background-color: #fff;
    cursor: pointer;
    font-weight: bold;
}

.custom-select-wrapper::after {
    content: '▼';
    position: absolute;
    top: 50%;
    right: 15px;
    transform: translateY(-50%);
    pointer-events: none;
}

.main-actions {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
    margin-left: 40px;
}

.btn-main {
    padding: 15px 30px;
    font-size: 1.2em;
    background-color: var(--red);
    color: white;
    border: 2px solid white;
    box-shadow: 0 0 15px white;
    animation: pulse 2s infinite;
}

@keyframes pulse {
    0% { box-shadow: 0 0 15px white; }
    50% { box-shadow: 0 0 25px white; }
    100% { box-shadow: 0 0 15px white; }
}

.btn-sub {
    padding: 10px 20px;
    font-size: 1em;
    background-color: var(--red);
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

.info-btn {
    position: fixed;
    top: 20px;
    right: 20px;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    background-color: var(--soft-red);
    color: var(--red);
    border: none;
    font-size: 20px;
    font-weight: bold;
    cursor: pointer;
    z-index: 2001;
}

/* Tidy, centered dialog — compact and centered */
.dialog{
  background:#fff;
  color:var(--ink);
  border-radius:16px;
  padding:20px;
  width: min(640px, 92vw);    /* keep it compact */
  max-height: 85vh;           /* avoid overflowing small screens */
  overflow: auto;
  box-shadow:0 30px 80px rgba(0,0,0,.35);
}
.dialog .close{ float:right; }

/* ---------- Start-screen background image ---------- */
/* Hidden by default; visible only while the Start modal is open */
.start-bg{
  position: fixed;
  inset: 0;
  background:
    linear-gradient(rgba(20,17,15,.30), rgba(20,17,15,.30)),
    url('../assets/bg_server.jpg') center / cover no-repeat;
  z-index: 1500;              /* above app, below modal */
  opacity: 0;                 /* hidden by default */
  transition: opacity .35s ease;
  pointer-events: none;       /* clicks go to modal */
}

/* Show the image ONLY while the Start modal is open */
#startModal.open ~ .start-bg { opacity: 1; }

hr{ border:none; border-top:1px solid var(--rail); margin:12px 0; }
@media (max-width: 980px){ .grid{ grid-template-columns:1fr; } }

/* Reveal-on-loss styling for traitors */
.player-card.revealed-traitor{
  outline:3px solid var(--red);
  box-shadow:0 0 0 4px rgba(204,31,42,.15);
  animation: traitor-pulse 1.2s ease-in-out 2;
}
@keyframes traitor-pulse{
  0%{ transform: scale(1); }
  50%{ transform: scale(1.03); }
  100%{ transform: scale(1); }
}

/* Log & start modal content animation */
.explain-overlay{
  position: fixed; inset:0;
  background: rgba(0,0,0,.6);
  display:flex; align-items:center; justify-content:center;
  z-index: 3000;
}
.explain-dialog{
  background:#fff; color:var(--ink);
  border-radius:16px; padding:24px; max-width:480px;
  box-shadow:0 20px 60px rgba(0,0,0,.30);
  animation: pop-in .25s ease-out;
}
@keyframes pop-in{ from{ transform:scale(.98); opacity:0; } to{ transform:scale(1); opacity:1; } }

/* Buttons & micro-interactions */
#answerBtn:disabled{ opacity:.6; cursor:not-allowed; }
.shake{ animation: btn-shake .3s; }
@keyframes btn-shake{
  0%{ transform: translateX(0); }
  25%{ transform: translateX(-3px); }
  50%{ transform: translateX(3px); }
  75%{ transform: translateX(-2px); }
  100%{ transform: translateX(0); }
}

/* Onboarding box */
.instructions{
  background: rgba(255,255,255,0.7);
  border: 1px solid var(--rail);
  border-radius: 10px;
  padding: 10px 14px;
}
.instructions h3{ color: var(--red); font-size: 16px; margin: 0 0 8px; }
.instructions p{ margin: 0; }

/* Greys out Daily Activity until scenario answered */
#actions.is-disabled {
  position: relative;
  opacity: .45;
  filter: grayscale(1);
  pointer-events: none;
}
#actions.is-disabled::after {
  content: 'Answer the next scenario to unlock';
  position: absolute; inset: 0;
  display: flex; align-items:center; justify-content:center;
  background: rgba(255,255,255,.55);
  color: var(--muted);
  font-weight: 700;
  letter-spacing: .02em;
  backdrop-filter: blur(1px);
}

.explain-dialog.with-character {
  display: flex;
  align-items: center;
  gap: 20px;
  max-width: 560px; /* Wider for avatar */
}
.explain-character-avatar {
  width: 100px;
  height: 100px;
  border-radius: 50%;
  object-fit: cover;
  border: 3px solid var(--rail);
}
.explain-text {
  flex: 1;
}
.explain-text button {
  margin-top: 12px;
}

/* Round header animations */
.round-title { display:inline-flex; align-items:baseline; gap:.4rem; }
.round-title .round-label { text-transform:uppercase; font-weight:800; letter-spacing:.08em; color:var(--muted); }
.round-title .round-num { font-weight:800; color:var(--ink); }
.round-pulse { animation: roundPulse .6s ease; }
.round-num-flash { animation: numFlash .9s ease; }
@keyframes roundPulse { 0%{transform:scale(1);color:var(--muted)}40%{transform:scale(1.12);color:var(--red)}100%{transform:scale(1);color:var(--muted)}}
@keyframes numFlash { 0%{color:var(--red);transform:translateY(-1px)}100%{color:var(--ink);transform:translateY(0)}}

/* ---------- End Game Modal ---------- */
.end-game-modal {
  display: flex;
  align-items: center;
  gap: 20px;
  padding: 20px;
}
.end-game-modal .avatars {
  display: flex;
  flex-direction: column;
  gap: 10px;
}
.end-game-modal .avatars img {
  width: 100px;
  height: 100px;
  border-radius: 50%;
  object-fit: cover;
  border: 3px solid var(--rail);
  box-shadow: 0 4px 12px rgba(0,0,0,.1);
}
.end-game-modal .message {
  flex: 1;
}
.end-game-modal .message h3 {
  margin-top: 0;
  font-size: 16px;
  color: var(--muted);
}
.end-game-modal .message p {
  font-size: 18px;
  font-style: italic;
  color: var(--ink);
  margin: 8px 0;
}
.scenario-actions {
  display: grid;
  grid-template-columns: 1fr auto 1fr;
  gap: 10px;
  align-items: center;
}
#openLogBtn {
  justify-self: start;
}
#restartBtn {
  justify-self: center;
}
#answerBtn {
  justify-self: end;
}
/* Responsive stacking for smaller screens */
@media (max-width: 600px) {
  .scenario-actions {
    grid-template-columns: 1fr;
    justify-items: stretch; /* Stretch buttons to full width */
  }
  #openLogBtn, #restartBtn, #answerBtn {
    justify-self: stretch; /* Ensure they take full width */
    text-align: center;
  }
}

/* === Start menu layout fix: centered two-column layout under the logo === */
#startModal .dialog.main-menu {
  display: grid;                       /* replace the old flex column */
  grid-template-columns: 420px 300px;  /* preview left, buttons right */
  justify-content: center;             /* center the pair as a unit */
  align-items: center;                  /* vertical alignment between columns */
  column-gap: 40px;
  row-gap: 20px;
  padding-bottom: 50px;
  background: transparent;
  box-shadow: none;
  border: none;
  overflow: visible;
  max-width: 980px;
  margin: 6vh auto;
}

/* Logo spans both columns and stays centered */
#startModal .dialog.main-menu .main-logo {
  grid-column: 1 / -1;
  justify-self: center;
  max-width: 500px;
  margin-bottom: .5rem;
}

/* Left column: hug the left edge so the pair feels balanced */
#startModal .dialog.main-menu .character-display-container {
  justify-self: start;
  gap: 10px;
}

/* Right column: tidy, consistent width and no stray margins */
#startModal .dialog.main-menu .main-actions {
  justify-self: start;
  align-self: center;
  display: grid;
  gap: 12px;
  width: 300px;
  margin-left: 0;
}

/* Label legibility on dark background */
.custom-select-wrapper label {
  display: block;
  margin-bottom: 6px;
  color: #fff;
  font-weight: 600;
  text-align: center;
  text-shadow: 0 1px 2px rgba(0,0,0,.35);
}

/* Keep the select close to the label width */
.custom-select-wrapper { width: 260px; }

/* Mobile: stack neatly */
@media (max-width: 900px) {
  #startModal .dialog.main-menu {
    grid-template-columns: 1fr;
    justify-content: center;
    align-items: start;
    max-width: min(92vw, 560px);
  }
  #startModal .dialog.main-menu .main-actions {
    width: min(320px, 90vw);
    justify-self: center;
  }
}
